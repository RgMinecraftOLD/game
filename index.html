<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>MiniCraft</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

<style>
html, body {
  margin: 0;
  padding: 0;
  overflow: hidden;
  background: #87CEEB;
}

#info {
  position: fixed;
  top: 10px;
  left: 10px;
  color: white;
  font-family: Arial;
  background: rgba(0,0,0,0.4);
  padding: 8px;
  border-radius: 8px;
  z-index: 10;
}

/* –ö–Ω–æ–ø–∫–∏ */
.btn {
  position: fixed;
  width: 60px;
  height: 60px;
  border-radius: 50%;
  background: rgba(0,0,0,0.4);
  color: white;
  font-size: 30px;
  display: flex;
  align-items: center;
  justify-content: center;
  user-select: none;
}

#up { left: 80px; bottom: 140px; }
#down { left: 80px; bottom: 40px; }
#left { left: 20px; bottom: 90px; }
#right { left: 140px; bottom: 90px; }

#hit {
  right: 20px;
  bottom: 80px;
  width: 90px;
  height: 90px;
  background: rgba(200,50,50,0.7);
  font-size: 20px;
}
</style>
</head>
<body>

<div id="info">MiniCraft ‚Äî –∫–Ω–æ–ø–∫–∏ –¥–ª—è –¥–≤–∏–∂–µ–Ω–∏—è, –∫—Ä–∞—Å–Ω–∞—è ‚Äî –±–∏—Ç—å</div>

<div id="up" class="btn">‚¨ÜÔ∏è</div>
<div id="down" class="btn">‚¨áÔ∏è</div>
<div id="left" class="btn">‚¨ÖÔ∏è</div>
<div id="right" class="btn">‚û°Ô∏è</div>
<div id="hit" class="btn">–ë–ò–¢–¨</div>

<script src="https://cdn.babylonjs.com/babylon.js"></script>

<script>
const canvas = document.createElement("canvas");
canvas.style.width = "100%";
canvas.style.height = "100%";
document.body.appendChild(canvas);

const engine = new BABYLON.Engine(canvas, true);
const scene = new BABYLON.Scene(engine);
scene.clearColor = new BABYLON.Color3(0.5, 0.8, 1.0);

// –í–∫–ª—é—á–∞–µ–º –∫–æ–ª–ª–∏–∑–∏–∏ –∏ –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏—é
scene.collisionsEnabled = true;
scene.gravity = new BABYLON.Vector3(0, -0.2, 0);

// –ö–∞–º–µ—Ä–∞ (–ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø!)
const camera = new BABYLON.UniversalCamera("cam", new BABYLON.Vector3(0, 2, -6), scene);
camera.attachControl(canvas, true);
camera.speed = 0.25;
camera.applyGravity = true;
camera.ellipsoid = new BABYLON.Vector3(0.5, 1, 0.5);
camera.checkCollisions = true;

// –°–ú–û–¢–†–ï–¢–¨ –í –¶–ï–ù–¢–†
camera.setTarget(new BABYLON.Vector3(0, 0, 0));

// –°–≤–µ—Ç
new BABYLON.HemisphericLight("light", new BABYLON.Vector3(0,1,0), scene);

// –ú–∞—Ç–µ—Ä–∏–∞–ª —Ç—Ä–∞–≤—ã
const grassMat = new BABYLON.StandardMaterial("grass", scene);
grassMat.diffuseColor = new BABYLON.Color3(0.3, 0.7, 0.3);

// –ó–µ–º–ª—è –∏–∑ –±–ª–æ–∫–æ–≤
for (let x = -15; x <= 15; x++) {
  for (let z = -15; z <= 15; z++) {
    const box = BABYLON.MeshBuilder.CreateBox("b", {size:1}, scene);
    box.position.set(x, -1, z); // üëà –í–ê–ñ–ù–û: –Ω–∏–∂–µ –∫–∞–º–µ—Ä—ã
    box.material = grassMat;
    box.checkCollisions = true;
  }
}

// üëâ –¢–ï–°–¢-–ë–õ–û–ö –ü–ï–†–ï–î –ù–û–°–û–ú (—á—Ç–æ–±—ã 100% –±—ã–ª–æ –≤–∏–¥–Ω–æ)
const testBox = BABYLON.MeshBuilder.CreateBox("test", {size:1}, scene);
testBox.position.set(0, 0, 2);
testBox.material = new BABYLON.StandardMaterial("t", scene);
testBox.material.diffuseColor = new BABYLON.Color3(1,0,0);

// –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∞–º–∏
const move = { forward:false, back:false, left:false, right:false };

function bind(id, key) {
  const el = document.getElementById(id);
  el.addEventListener("touchstart", ()=> move[key]=true);
  el.addEventListener("touchend", ()=> move[key]=false);
}

bind("up","forward");
bind("down","back");
bind("left","left");
bind("right","right");

// –î–≤–∏–∂–µ–Ω–∏–µ
scene.onBeforeRenderObservable.add(() => {
  const f = camera.getDirection(BABYLON.Axis.Z);
  const r = camera.getDirection(BABYLON.Axis.X);

  if (move.forward) camera.moveWithCollisions(f.scale(0.15));
  if (move.back) camera.moveWithCollisions(f.scale(-0.15));
  if (move.left) camera.moveWithCollisions(r.scale(-0.15));
  if (move.right) camera.moveWithCollisions(r.scale(0.15));
});

// –ö–Ω–æ–ø–∫–∞ "–±–∏—Ç—å"
document.getElementById("hit").addEventListener("touchstart", () => {
  testBox.dispose();
});

// –ó–∞–ø—É—Å–∫
engine.runRenderLoop(() => scene.render());
window.addEventListener("resize", () => engine.resize());
</script>

</body>
</html>
